$LOCKSCREEN = lockscreen.sh
$PowerActions = ~/.config/hypr/scripts/power-action.sh

general {
    lock_cmd = $LOCKSCREEN
    before_sleep_cmd = $LOCKSCREEN
    ignore_dbus_inhibit = false
    ignore_systemd_inhibit = false
}

# ──────────── Battery Actions ────────────

# Notify before dimming brightness on battery (10s before)
listener {
    timeout = 80
    on-timeout = $PowerActions notify battery "System inactive. Dimming brightness in 10 seconds."
}

# Dim brightness after 1.5 minutes on battery
listener {
    timeout = 90
    on-timeout = $PowerActions brightness battery
    on-resume = $PowerActions notify battery "Activity detected. Skipping brightness dim." && brightnessctl -r
}

# Notify before lock screen on battery (10s before)
listener {
    timeout = 110
    on-timeout = $PowerActions notify battery "System inactive. Locking screen in 10 seconds."
}

# Lock screen after 2 minutes on battery
listener {
    timeout = 120
    on-timeout = $PowerActions lock battery
}

# Notify before turning off display on battery (20s before)
listener {
    timeout = 220
    on-timeout = $PowerActions notify battery "System inactive. Display will turn off in 20 seconds."
}

# Turn off display after 4 minutes on battery
listener {
    timeout = 240
    on-timeout = $PowerActions dpms_off battery
    on-resume =  hyprctl dispatch dpms on
}

# Progressive suspend warning on battery (1min, 30s before)
listener {
    timeout = 300
    on-timeout = $PowerActions notify battery "System inactive. Suspending in 1 minute."
}
listener {
    timeout = 330
    on-timeout = $PowerActions notify battery "System inactive. Suspending in 30 seconds."
}

# Suspend after 6 minutes on battery
listener {
    timeout = 360
    on-timeout = $PowerActions suspend battery
    on-resume = $PowerActions notify battery "System resumed from suspend."
}

# ──────────── AC Actions ────────────

# Notify before dimming brightness on AC (10s before)
listener {
    timeout = 590
    on-timeout = $PowerActions notify ac "System inactive. Dimming brightness in 10 seconds."
}

# Dim brightness after 10 minutes on AC
listener {
    timeout = 600
    on-timeout = $PowerActions brightness ac
    on-resume = $PowerActions notify ac "Activity detected. Skipping brightness dim." && brightnessctl -r
}

# Notify before lock screen on AC (10s before)
listener {
    timeout = 410
    on-timeout = $PowerActions notify ac "System inactive. Locking screen in 10 seconds."
}

# Lock screen after 7 minutes on AC
listener {
    timeout = 420
    on-timeout = $PowerActions lock ac
}

# Notify before display off on AC (20s before)
listener {
    timeout = 7180
    on-timeout = $PowerActions notify ac "System inactive. Display will turn off in 20 seconds."
}

# Turn off display after 2 hours on AC
listener {
    timeout = 12
    on-timeout = $PowerActions dpms_off ac
    on-resume = hyprctl dispatch dpms on
}
# Turn off display after 2 hours on AC
listener {
    timeout = 15
    on-timeout = $PowerActions dpms_off power
    on-resume = hyprctl dispatch dpms on
}

# Progressive suspend warning on AC (2mins, 30s before)
listener {
    timeout = 10680
    on-timeout = $PowerActions notify ac "System inactive. Suspending in 2 minutes."
}
listener {
    timeout = 10770
    on-timeout = $PowerActions notify ac "System inactive. Suspending in 30 seconds."
}

# Suspend after 3 hours on AC
listener {
    timeout = 10800
    on-timeout = $PowerActions suspend ac
    on-resume = $PowerActions notify ac "System resumed from suspend."
}

# hyprlang noerror true
source = ~/.config/hypridle/*
# hyprlang noerror false
